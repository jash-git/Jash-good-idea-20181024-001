var usurl,account,this_client_width=document.documentElement.clientWidth,staticmain="https://www.everydayhealth.com.tw/";function checkAccount(t,o){usurl=staticmain+"newcheckExist.do",""==(account=document.querySelector(t).value)?alert("請輸入「帳號」"):account.length<5||!account.match(/^[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*@[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*\.+[a-zA-Z]+$/)?alert("您輸入的Email有空白或是錯誤字元，請再檢查並重新填寫喔！"):$.ajax({headers:{Accept:"text/plain","Content-Type":"application/json"},url:usurl,type:"get",data:"account="+account,dataType:"json",success:function(e){e.exist?($(t).val(""),$(t).focus(),alert(e.msg)):"register"==o?document.getElementById("jForm_test").submit():alert(e.msg)},error:function(e){}})}function checkForm(e){usurl=staticmain+"newcheckForm.do",account=$("#jam_email").val().trim();var t=$("#jam_name").val(),o=$("#jpassword").val(),n=$("#jpassword2").val(),i="",a=$("#jterms").is(":checked"),c=$("#jam_source").val();""==account||"請輸入帳號"==account?i+="請輸入「帳號」":(account.length<5||!account.match(/^[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*@[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*\.+[a-zA-Z]+$/))&&(i+="您輸入的Email有空白或是錯誤字元，請再檢查並重新填寫喔！"),""==t.trim()?i+="\n請填入「暱稱」":10<t.trim().length&&(i+="\n暱稱請在 10 字內"),o.length<8?i+="\n密碼最少需8個字元!":o!==n&&(i+="\n密碼與確認密碼不符!"),a||(i+="\n請勾選「同意服務條款」"),"W0"!==c&&(i+="\n警告!!請勿隨意修改代碼!!"),""==i?$.postjson(usurl,"account="+account+"&password="+o,function(e){""==(i+=e.msg)?document.getElementById("jForm").submit():alert(i)}):alert(i)}function checkName(){$("#subform2").hide(),checkAccount(),account=$("#am_email").val().trim();var e=$("#terms").is(":checked"),t=$("#am_name").val(),o="";$("#am_source").val();(account.length<5||!account.match(/^[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*@[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*\.+[a-zA-Z]+$/))&&(o+="\n 您輸入的Email有空白或是錯誤字元，請再檢查並重新填寫喔！"),""==t.trim()&&(o+="\n請填入「暱稱」"),e||(o+="\n請勾選「同意服務條款」"),""==o?document.getElementById("jForm_test").submit():($("#subform2").show(),alert(o))}function new_login(t){var o=staticmain;if(checkisok=checkForm2(),1==checkisok){var n=$("#textfield2").val().trim();$.get("https://static.everydayhealth.com.tw/vendors/blueimp-md5-2.3.0/md5.min.js",function(){var e=md5($("#textfield3").val());loginajax(o,n,e,t)})}}function fblogina(e){var t=document.querySelector(".fb_login_button"),o=document.querySelector(".login-fb-title"),n=document.querySelector(".fb_login_button_injoin");null!=t&&(t.disabled=!0,o.innerText="請稍等"),null!=n&&(n.disabled=!0);var i="https://www.facebook.com/v3.0/dialog/oauth?client_id=373756266167393";i+="&redirect_uri="+staticmain+"fblogin.do",i+="&response_type=code",i+="&scope=public_profile%20email","true"==e?location.href=i:to_open_window(i,550),setTimeout(function(){null!=t&&(t.disabled=!1,o.innerText="登入"),null!=n&&(n.disabled=!1)},3e3)}function linelogin(e,t){var o=document.querySelector(".line_login_button"),n=document.querySelector(".line_login_button_injoin"),i=document.querySelector(".login-line-title");null!=o&&(o.disabled=!0,i.innerText="請稍等"),null!=n&&(n.disabled=!0);var a="https://access.line.me/oauth2/v2.1/authorize?";a+="response_type=code",a+="&client_id=1574727086",a+="&redirect_uri="+staticmain+"lineoauth.do",a+="&state="+e,a+="&scope=openid%20profile","true"==t?location.href=a:to_open_window(a,550),setTimeout(function(){null!=o&&(o.disabled=!1,i.innerText="登入"),null!=n&&(n.disabled=!1)},3e3)}function loginajax(t,e,o,n){var i=e+"#"+o+"#"+n;$.postjson(t+"emlogin.do","data="+i,function(e){alert(e.msg),e.torf?location.href=t+e.url:($("#textfield3").val(""),e.re&&(location.href=t+e.url))})}function checkForms(){var e=document.getElementById("account").value;""==e?alert("請輸入Email"):e.length<5||!e.match(/^[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*@[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*\.+[a-zA-Z]+$/)?alert("您輸入的Email格式有錯誤，請再檢查並重新填寫喔！"):$("#command").submit()}function logout(){$.postwithcredentials(staticmain+"logouts.do","",function(e){alert(e.msg),-1<window.location.pathname.indexOf("memberCenter")?location.href=staticmain+e.url:location.reload()})}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function checkForm2(){var e="",t=$("#textfield2").val().trim(),o=$("#textfield3").val().trim();return""==t||"請輸入帳號"==t?e+="請輸入「帳號」":(t.length<5||!t.match(/^[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*@[0-9a-zA-Z]([-._]*[0-9a-zA-Z])*\.+[a-zA-Z]+$/))&&(e+="您輸入的Email有空白或是錯誤字元，請再檢查並重新填寫喔！"),""==o?e+="\n請輸入「密碼」":o.length<8&&(e+="\n密碼最少為8個字元!"),""==e||(alert(e),!1)}var isIe=!!document.all;function setSelectState(e){for(var t=document.getElementsByTagName("select"),o=0;o<t.length;o++)t[o].style.visibility=e}function mousePosition(){return{x:.6*document.body.clientWidth,y:70}}function showMessageBox(e,t,o,n){closeWindow();var i=document.getElementById("container"),a=parseInt(document.documentElement.scrollWidth),c=parseInt(document.documentElement.scrollHeight);isIe&&setSelectState("hidden");var l=document.createElement("div");l.id="back";var r="top:0px;left:0px;position:absolute;background:#666;width:"+a+"px;height:"+c+"px;";r+=isIe?"filter:alpha(opacity=0);":"opacity:0;",l.style.cssText=r,i.appendChild(l),showBackground(l,50);var s=document.createElement("div");s.id="mesWindow",s.className="mesWindow",s.innerHTML="<div class='mesWindowTop' style='background-color:#86c81e;color:#fff;'><table width='100%' height='100%'><tr><td> "+e+"</td><td style='width:1px;'><input type='button' onclick='closeWindow();' title='關閉訊息視窗' class='close' value='X' style='background-color:#86c81e;color:#fff;'/></td></tr></table></div><div class='mesWindowContent' id='mesWindowContent'>"+t+"</div><div class='mesWindowBottom'></div>",r="left:"+(0<o.x-n?o.x-n:50)+"px;top:"+o.y+"px;position:absolute;width:"+(0<o.x-n?n:270)+"px;",s.style.cssText=r,i.appendChild(s)}function showBackground(e,t){if(isIe)e.filters.alpha.opacity+=1,e.filters.alpha.opacity<t&&setTimeout(function(){showBackground(e,t)},5);else{var o=parseFloat(e.style.opacity);o+=.01,(e.style.opacity=o)<t/100&&setTimeout(function(){showBackground(e,t)},5)}}function closeWindow(){null!=document.getElementById("back")&&document.getElementById("back").parentNode.removeChild(document.getElementById("back")),null!=document.getElementById("mesWindow")&&document.getElementById("mesWindow").parentNode.removeChild(document.getElementById("mesWindow")),isIe&&setSelectState("")}function testMessageBox(e){var t=mousePosition();messContent="<div style='padding:20px 0 20px 0;text-align:center;background-color:#FFF;'> 您登入失敗有可能是未開啟FB的EMAIL授權權限，<p>請按此操作即可登入，<p>謝謝。<p> <a href='/event/fb_account_reauthorizationPage.do'>FACEBOOK帳號重新授權流程</a></div>",showMessageBox("&nbsp;&nbsp;&nbsp;警告",messContent,t,500)}function to_open_window(e,t){var o="";0<t&&(o="top=100,left="+parseInt(this_client_width/2-t/2)+",width="+t+",height="+.8*t),window.open(e,"_blank",o)}function to_open_link(e){top.location.href=e}function register_callback(e){$("#login_layer").remove();var t=document.getElementById("cboxContent");t.innerHTML="";var o=e;try{t.appendChild(o)}catch(e){t.innerHTML=o.outerHTML}e.style.display="block",OpenLinkRegister("#social_register")}function login_callback(){document.getElementById("cboxContent").style.display="none",window.location.href="/memberCenter.do"}function login_register(){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),location.hostname.startsWith("yahoo")?window.location.href="/join":OpenLinkLogin("#login_layer")}function OpenLinkLogin(e){var t=350,o=300,n=$(window).innerWidth()-50;(n<t&&(o=Math.floor(o*n/t),t=n),o<320&&(o=270),t<450)&&(document.querySelector(".login-line-title").innerHTML="Line",document.querySelector(".login-fb-title").innerHTML=" FB");$.colorbox({href:e,inline:!0,scrolling:0,width:"80%",maxWidth:t,height:"100%",maxHeight:o+70,opacity:"0.3",onLoad:function(){$(e).show(),$(".hidebox").hide(),$("#cboxClose").remove(),$("#cboxLoadingOverlay").remove(),$("#cboxContent").css("backgroundColor","white")}})}function OpenLinkRegister(e){var t=550,o=450,n=$(window).innerWidth()-50,i=$(window).innerHeight();(n<t&&(o=Math.floor(o*n/t),t=n),t<760&&(o=550),i<n&&i<768&&n<768)&&(document.querySelector(".social_picture_register").style.display="none",document.querySelector(".mobile_none_padding").style.paddingTop="15px");$.colorbox.close;$.colorbox.close=function(e){confirm("確定要離開註冊頁面?")&&(location.href="/index.do")},$.colorbox({href:e,inline:!0,scrolling:0,width:"100%",maxWidth:t,height:"100%",maxHeight:o-100,opacity:"0.3",onLoad:function(){$(e).show(),$(".hidebox").hide(),$("#cboxClose").remove(),$("#cboxLoadingOverlay").remove()}}),window.onbeforeunload=function(){return"確定要離開註冊頁面?"}}function CloseColorbox(){$.colorbox.close()}function CloseColorbox_inapp(){confirm("確定要離開註冊頁面?")&&(location.href="/index.do")}